<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>LLM architecture on My work notes</title>
    <link>http://localhost:1313/llm/architecture/</link>
    <description>Recent content in LLM architecture on My work notes</description>
    <generator>Hugo -- 0.152.2</generator>
    <language>zh-CN</language>
    <lastBuildDate>Wed, 07 Jan 2026 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/llm/architecture/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>MLAï¼šMulti-head Latent Attention</title>
      <link>http://localhost:1313/llm/architecture/mla/</link>
      <pubDate>Wed, 07 Jan 2026 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/llm/architecture/mla/</guid>
      <description>&lt;h2 id=&#34;ä¸€mla-çš„ç”±æ¥&#34;&gt;ä¸€ã€MLA çš„ç”±æ¥&lt;/h2&gt;
&lt;h3 id=&#34;èƒŒæ™¯kv-cache-æˆä¸ºæ¨ç†ç“¶é¢ˆ&#34;&gt;èƒŒæ™¯ï¼šKV Cache æˆä¸ºæ¨ç†ç“¶é¢ˆ&lt;/h3&gt;
&lt;p&gt;åœ¨ Transformer è§£ç å™¨ä¸­ï¼Œè‡ªå›å½’ç”Ÿæˆæ—¶éœ€ç¼“å­˜æ‰€æœ‰å†å² token çš„ Key å’Œ Valueï¼ˆå³ KV Cacheï¼‰ã€‚éšç€ä¸Šä¸‹æ–‡é•¿åº¦å¢é•¿ï¼ˆå¦‚ 32Kã€128K tokensï¼‰ï¼ŒKV Cache å ç”¨å¤§é‡æ˜¾å­˜å’Œå¸¦å®½ï¼Œæˆä¸ºæ¨ç†æ•ˆç‡çš„ä¸»è¦ç“¶é¢ˆã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç›®æ ‡å‹ç¼©-kv-cache&#34;&gt;ç›®æ ‡ï¼šå‹ç¼© KV Cache&lt;/h3&gt;
&lt;p&gt;ä¸ºå‡å°‘ KV Cache å¤§å°ï¼Œç ”ç©¶è€…æå‡ºå¤šç§å‹ç¼©æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MQAï¼ˆMulti-Query Attentionï¼‰&lt;/strong&gt;ï¼šæ‰€æœ‰å¤´å…±äº«ä¸€ç»„ K/Vã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;GQAï¼ˆGrouped-Query Attentionï¼‰&lt;/strong&gt;ï¼šå°†å¤šä¸ªå¤´åˆ†ç»„å…±äº« K/Vã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;MLAï¼ˆMulti-head Latent Attentionï¼‰&lt;/strong&gt;ï¼š&lt;strong&gt;ä¸ç›´æ¥å­˜å‚¨åŸå§‹ K/Vï¼Œè€Œæ˜¯å­¦ä¹ ä¸€ä¸ªä½ç»´â€œæ½œåœ¨è¡¨ç¤ºâ€ï¼ˆlatent codeï¼‰ï¼Œé€šè¿‡å°å‹ç½‘ç»œåŠ¨æ€é‡å»ºè¿‘ä¼¼çš„ K/V&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æå‡ºè€…ä¸å‡ºå¤„&#34;&gt;æå‡ºè€…ä¸å‡ºå¤„&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;DeepSeek-V2ï¼ˆ2024ï¼‰&lt;/strong&gt; é¦–æ¬¡ç³»ç»Ÿæ€§æå‡ºå¹¶å‘½å &lt;strong&gt;MLAï¼ˆMulti-head Latent Attentionï¼‰&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ ¸å¿ƒæ€æƒ³ï¼šç”¨ &lt;strong&gt;ä½ç§©æ½œåœ¨å‘é‡ + å°å‹æŠ•å½±ç½‘ç»œ&lt;/strong&gt; ä»£æ›¿ä¼ ç»Ÿ KV Cacheï¼Œå¤§å¹…é™ä½å†…å­˜å ç”¨ï¼ˆè®ºæ–‡ç§°å‡å°‘ 77% KV Cacheï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;img src=&#34;MLA.jpg&#34; alt=&#34;MLA&#34; style=&#34;width:80%;height:auto;&#34;&gt;
&lt;hr&gt;
&lt;h2 id=&#34;äºŒåŸºæœ¬åŸç†&#34;&gt;äºŒã€åŸºæœ¬åŸç†&lt;/h2&gt;
&lt;p&gt;MLA çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ä¸æ˜¾å¼å­˜å‚¨æ¯ä¸ª token çš„ K å’Œ Vï¼Œè€Œæ˜¯å­˜å‚¨ä¸€ä¸ªç´§å‡‘çš„â€œæ½œåœ¨å‘é‡â€ $ z_t \in \mathbb{R}^{d_z} $ï¼ˆ$ d_z \ll d_k, d_v $ï¼‰ï¼Œåœ¨éœ€è¦æ—¶é€šè¿‡è½»é‡çº§å¯å­¦ä¹ æ˜ å°„ $ f_K, f_V $ åŠ¨æ€é‡å»º K å’Œ Vã€‚&lt;/strong&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>SwiGLUæ¿€æ´»å‡½æ•°è§£æ</title>
      <link>http://localhost:1313/llm/architecture/swiglu%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0/</link>
      <pubDate>Wed, 07 Jan 2026 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/llm/architecture/swiglu%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0/</guid>
      <description>&lt;p&gt;SwiGLUï¼ˆSwish-Gated Linear Unitï¼‰æ˜¯ä¸€ç§åœ¨ç°ä»£å¤§è¯­è¨€æ¨¡å‹ï¼ˆå¦‚PaLMã€LLaMAç­‰ï¼‰ä¸­å¹¿æ³›ä½¿ç”¨çš„æ¿€æ´»å‡½æ•°å˜ä½“ï¼Œç”¨äºæ›¿ä»£ä¼ ç»Ÿçš„å‰é¦ˆç½‘ç»œï¼ˆFeed-Forward Network, FFNï¼‰ä¸­çš„ ReLU æˆ– GELUã€‚å®ƒç»“åˆäº†é—¨æ§æœºåˆ¶ï¼ˆgatingï¼‰ä¸ Swish æ¿€æ´»å‡½æ•°ï¼Œå…·æœ‰æ›´å¼ºçš„è¡¨è¾¾èƒ½åŠ›å’Œè®­ç»ƒç¨³å®šæ€§ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;ä¸€swiglu-çš„ç”±æ¥&#34;&gt;ä¸€ã€SwiGLU çš„ç”±æ¥&lt;/h2&gt;
&lt;p&gt;SwiGLU æœ€æ—©ç”± &lt;strong&gt;Shazeer (2020)&lt;/strong&gt; åœ¨è®ºæ–‡ã€Š&lt;strong&gt;GLU Variants Improve Transformer&lt;/strong&gt;ã€‹ä¸­ç³»ç»Ÿæ€§åœ°æå‡ºå¹¶è¯„ä¼°ã€‚è¯¥å·¥ä½œæ¢ç´¢äº†å¤šç§åŸºäº &lt;strong&gt;Gated Linear Unit (GLU)&lt;/strong&gt; çš„æ¿€æ´»å‡½æ•°å˜ä½“ï¼Œå¹¶å‘ç° &lt;strong&gt;SwiGLU&lt;/strong&gt; åœ¨è¯­è¨€å»ºæ¨¡ä»»åŠ¡ä¸­è¡¨ç°æœ€ä¼˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;èƒŒæ™¯glugated-linear-unit&#34;&gt;èƒŒæ™¯ï¼šGLUï¼ˆGated Linear Unitï¼‰&lt;/h3&gt;
&lt;p&gt;GLU æœ€åˆç”± Dauphin ç­‰äººï¼ˆ2017ï¼‰åœ¨ã€ŠLanguage Modeling with Gated Convolutional Networksã€‹ä¸­æå‡ºï¼Œå…¶åŸºæœ¬å½¢å¼ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;[
\text{GLU}(x) = (W_1 x + b_1) \otimes \sigma(W_2 x + b_2)
]&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;( \otimes ) è¡¨ç¤ºé€å…ƒç´ ä¹˜æ³•ï¼ˆHadamard productï¼‰ï¼Œ&lt;/li&gt;
&lt;li&gt;( \sigma ) æ˜¯ Sigmoid æ¿€æ´»å‡½æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;GLU å¼•å…¥äº†â€œé—¨æ§â€æ€æƒ³ï¼šä¸€éƒ¨åˆ†çº¿æ€§å˜æ¢è¢«å¦ä¸€éƒ¨åˆ†é€šè¿‡æ¿€æ´»å‡½æ•°â€œé—¨æ§â€ï¼Œä»è€Œå®ç°æ›´çµæ´»çš„ä¿¡æ¯æ§åˆ¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;swiglu-çš„æ”¹è¿›&#34;&gt;SwiGLU çš„æ”¹è¿›&lt;/h3&gt;
&lt;p&gt;SwiGLU å°† GLU ä¸­çš„ Sigmoid æ›¿æ¢ä¸º &lt;strong&gt;Swish&lt;/strong&gt;ï¼ˆä¹Ÿç§° SiLUï¼‰æ¿€æ´»å‡½æ•°ï¼š&lt;/p&gt;</description>
    </item>
    <item>
      <title>ALiBi - è§£å†³ä¼ ç»Ÿä½ç½®ç¼–ç å¤–æ¨é—®é¢˜</title>
      <link>http://localhost:1313/llm/architecture/alibi-%E8%A7%A3%E5%86%B3%E4%BC%A0%E7%BB%9F%E4%BD%8D%E7%BD%AE%E7%BC%96%E7%A0%81%E5%A4%96%E6%8E%A8%E9%97%AE%E9%A2%98/</link>
      <pubDate>Sun, 04 Jan 2026 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/llm/architecture/alibi-%E8%A7%A3%E5%86%B3%E4%BC%A0%E7%BB%9F%E4%BD%8D%E7%BD%AE%E7%BC%96%E7%A0%81%E5%A4%96%E6%8E%A8%E9%97%AE%E9%A2%98/</guid>
      <description>&lt;h2 id=&#34;ä¸€alibi-çš„ç”±æ¥ä¸ºä»€ä¹ˆéœ€è¦å®ƒ&#34;&gt;ä¸€ã€ALiBi çš„ç”±æ¥ï¼šä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ&lt;/h2&gt;
&lt;h3 id=&#34;1-ä¼ ç»Ÿä½ç½®ç¼–ç çš„å¤–æ¨é—®é¢˜&#34;&gt;1. ä¼ ç»Ÿä½ç½®ç¼–ç çš„å¤–æ¨é—®é¢˜&lt;/h3&gt;
&lt;p&gt;åœ¨æ ‡å‡† Transformer ä¸­ï¼Œä½ç½®ä¿¡æ¯é€šè¿‡ &lt;strong&gt;ç»å¯¹ä½ç½®ç¼–ç ï¼ˆå¦‚æ­£å¼¦ã€å¯å­¦ä¹ ï¼‰æˆ–ç›¸å¯¹ä½ç½®ç¼–ç ï¼ˆå¦‚ RoPEï¼‰&lt;/strong&gt; æ³¨å…¥ã€‚ä½†è¿™äº›æ–¹æ³•åœ¨ &lt;strong&gt;è®­ç»ƒé•¿åº¦ &amp;lt; æ¨ç†é•¿åº¦&lt;/strong&gt; æ—¶è¡¨ç°ä¸ä½³ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç»å¯¹ä½ç½®ç¼–ç &lt;/strong&gt;ï¼šæ— æ³•å¤„ç†è®­ç»ƒæ—¶æœªè§è¿‡çš„ä½ç½®ç´¢å¼•&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RoPE&lt;/strong&gt;ï¼šè™½å¯é€šè¿‡æ’å€¼ï¼ˆå¦‚ YaRNï¼‰æ‰©å±•ï¼Œä½†å¤–æ¨èƒ½åŠ›ä»æœ‰é™ï¼Œä¸”éœ€é¢å¤–è°ƒå‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ é—®é¢˜æ ¸å¿ƒï¼š&lt;strong&gt;ä½ç½®ç¼–ç ä¸åºåˆ—é•¿åº¦å¼ºè€¦åˆ&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;2-alibi-çš„æå‡º&#34;&gt;2. ALiBi çš„æå‡º&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è®ºæ–‡&lt;/strong&gt;ï¼šã€Š&lt;a href=&#34;https://arxiv.org/abs/2108.12409&#34;&gt;Train Short, Test Long: Attention with Linear Biases Enables Input Length Extrapolation&lt;/a&gt;ã€‹ï¼ˆICLR 2022ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½œè€…&lt;/strong&gt;ï¼šOfir Press et al.ï¼ˆæ¥è‡ª AI21 Labsï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒæ€æƒ³&lt;/strong&gt;ï¼š&lt;strong&gt;å®Œå…¨ç§»é™¤ä½ç½®ç¼–ç &lt;/strong&gt;ï¼Œæ”¹ç”¨ &lt;strong&gt;ä¸è·ç¦»æˆçº¿æ€§å…³ç³»çš„åç½®ï¼ˆbiasï¼‰&lt;/strong&gt; ç›´æ¥åŠ åˆ° attention score ä¸Š&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… ä¼˜åŠ¿ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¨¡å‹å¯åœ¨çŸ­åºåˆ—ä¸Šè®­ç»ƒï¼Œåœ¨è¶…é•¿åºåˆ—ä¸Šç›´æ¥æ¨ç†ï¼ˆæ— éœ€å¾®è°ƒï¼‰&lt;/li&gt;
&lt;li&gt;æ¶æ„æ›´ç®€æ´ï¼ˆæ— ä½ç½®åµŒå…¥å±‚ï¼‰&lt;/li&gt;
&lt;li&gt;åœ¨é•¿ä¸Šä¸‹æ–‡ä»»åŠ¡ä¸Šè¡¨ç°ä¼˜å¼‚&lt;/li&gt;
&lt;li&gt;è¢« &lt;strong&gt;BLOOMï¼ˆ176Bï¼‰&lt;/strong&gt; ç­‰å¤§æ¨¡å‹é‡‡ç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 id=&#34;äºŒåŸºæœ¬åŸç†&#34;&gt;äºŒã€åŸºæœ¬åŸç†&lt;/h2&gt;
&lt;p&gt;ALiBi çš„å…³é”®æ´å¯Ÿæ˜¯ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;äººç±»è¯­è¨€ä¸­ï¼Œè¿‘æœŸ token é€šå¸¸æ¯”è¿œæœŸ token æ›´ç›¸å…³&lt;/strong&gt;ã€‚&lt;br&gt;
å› æ­¤ï¼Œæ³¨æ„åŠ›åº”å¤©ç„¶å€¾å‘äº &lt;strong&gt;å±€éƒ¨æ€§ï¼ˆlocalityï¼‰&lt;/strong&gt;ï¼Œä¸”è¡°å‡é€Ÿåº¦å¯ head-specific æ§åˆ¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸ºæ­¤ï¼ŒALiBi åœ¨è®¡ç®— attention score æ—¶ï¼Œå¯¹æ¯ä¸ª head å¼•å…¥ä¸€ä¸ª &lt;strong&gt;çº¿æ€§åç½®é¡¹&lt;/strong&gt;ï¼š&lt;/p&gt;</description>
    </item>
    <item>
      <title>RMSNormè§£æ - Root Mean Square Layer Normalization</title>
      <link>http://localhost:1313/llm/architecture/rmsnorm%E8%A7%A3%E6%9E%90/</link>
      <pubDate>Sun, 04 Jan 2026 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/llm/architecture/rmsnorm%E8%A7%A3%E6%9E%90/</guid>
      <description>&lt;p&gt;RMSNormï¼ˆRoot Mean Square Layer Normalizationï¼‰æ˜¯ä¸€ç§ç”¨äºå½’ä¸€åŒ–å±‚è¾“å…¥çš„å½’ä¸€åŒ–æ–¹æ³•ï¼Œå®ƒåŸºäºè¾“å…¥å‘é‡çš„å‡æ–¹æ ¹ï¼ˆRMSï¼‰ä½œä¸ºå½’ä¸€åŒ–çš„æƒé‡ã€‚RMSNorm çš„ä¸»è¦ä½œç”¨æ˜¯æé«˜è®­ç»ƒæ•ˆç‡ï¼Œå¹¶é˜²æ­¢æ¢¯åº¦çˆ†ç‚¸ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸€rmsnorm-çš„ç”±æ¥&#34;&gt;ä¸€ã€RMSNorm çš„ç”±æ¥&lt;/h2&gt;
&lt;h3 id=&#34;1-layer-normalizationlayernormçš„å±€é™æ€§&#34;&gt;1. Layer Normalizationï¼ˆLayerNormï¼‰çš„å±€é™æ€§&lt;/h3&gt;
&lt;p&gt;åœ¨ Transformer æ¶æ„ä¸­ï¼Œ&lt;strong&gt;LayerNorm&lt;/strong&gt; è¢«å¹¿æ³›ç”¨äºç¨³å®šè®­ç»ƒã€‚å…¶æ ‡å‡†å½¢å¼ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;[
\text{LayerNorm}(x) = \gamma \cdot \frac{x - \mu}{\sqrt{\sigma^2 + \epsilon}} + \beta
]&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(\mu = \frac{1}{d}\sum_{i=1}^d x_i)ï¼ˆå‡å€¼ï¼‰&lt;/li&gt;
&lt;li&gt;(\sigma^2 = \frac{1}{d}\sum_{i=1}^d (x_i - \mu)^2)ï¼ˆæ–¹å·®ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è™½ç„¶æœ‰æ•ˆï¼Œä½† &lt;strong&gt;å‡å»å‡å€¼ï¼ˆcenteringï¼‰æ“ä½œåœ¨è¯­è¨€å»ºæ¨¡ä»»åŠ¡ä¸­å¯èƒ½å¹¶éå¿…è¦&lt;/strong&gt;ï¼Œç”šè‡³å¯èƒ½å¹²æ‰°æŸäº›è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;h3 id=&#34;2-rmsnorm-çš„æå‡º&#34;&gt;2. RMSNorm çš„æå‡º&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è®ºæ–‡&lt;/strong&gt;ï¼šã€Š&lt;a href=&#34;https://arxiv.org/abs/1910.07467&#34;&gt;Root Mean Square Layer Normalization&lt;/a&gt;ã€‹ï¼ˆICLR 2020ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½œè€…&lt;/strong&gt;ï¼šBiao Zhang, Rico Sennrichï¼ˆæ¥è‡ªçˆ±ä¸å ¡å¤§å­¦ &amp;amp; Amazonï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒæ€æƒ³&lt;/strong&gt;ï¼š&lt;strong&gt;å»æ‰ centeringï¼ˆå³ä¸å‡å‡å€¼ï¼‰ï¼Œä»…åš scalingï¼ˆç¼©æ”¾ï¼‰&lt;/strong&gt;ï¼Œç”¨æ›´ç®€å•çš„å½’ä¸€åŒ–æ–¹å¼è¾¾åˆ°ç±»ä¼¼ç”šè‡³æ›´å¥½çš„æ•ˆæœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… ä¼˜åŠ¿ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è®¡ç®—æ›´ç®€å•ï¼ˆå°‘ä¸€æ¬¡å‡å‡å€¼ï¼‰&lt;/li&gt;
&lt;li&gt;å‡å°‘è®¡ç®—å¼€é”€ï¼ˆçº¦ 7%~10% fasterï¼‰&lt;/li&gt;
&lt;li&gt;åœ¨ NLP ä»»åŠ¡ä¸Šæ€§èƒ½ç›¸å½“æˆ–ç•¥ä¼˜&lt;/li&gt;
&lt;li&gt;æ›´é€‚åˆå¤§è§„æ¨¡è‡ªå›å½’è¯­è¨€æ¨¡å‹&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚ä»Šï¼Œ&lt;strong&gt;LLaMAã€Qwenã€Mistralã€DeepSeek ç­‰ä¸»æµå¤§æ¨¡å‹å…¨éƒ¨é‡‡ç”¨ RMSNorm&lt;/strong&gt;ï¼Œè€Œé LayerNormã€‚&lt;/p&gt;</description>
    </item>
    <item>
      <title>GQA - Grouped-query Attention åˆ†ç»„æŸ¥è¯¢æ³¨æ„åŠ›</title>
      <link>http://localhost:1313/llm/architecture/gqa/</link>
      <pubDate>Wed, 31 Dec 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/llm/architecture/gqa/</guid>
      <description>&lt;p&gt;GQAï¼ˆGrouped-Query Attentionï¼‰å°†å¤šä¸ªæŸ¥è¯¢å¤´ï¼ˆQuery headsï¼‰åˆ†ç»„ï¼Œæ¯ç»„å…±äº«åŒä¸€ä¸ªé”®/å€¼å¤´ï¼ˆKey/Value headï¼‰ï¼Œåœ¨æ˜¾è‘—é™ä½KVç¼“å­˜å’Œè®¡ç®—å¼€é”€çš„åŒæ—¶ï¼Œä¿æŒæ¥è¿‘å¤šå¤´æ³¨æ„åŠ›ï¼ˆMHAï¼‰çš„æ¨¡å‹æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;å®ƒåœ¨MHAï¼ˆå¤šå¤´ï¼‰å’ŒMQAï¼ˆå•å¤´KVï¼‰ä¹‹é—´å–å¾—é«˜æ•ˆä¸æ€§èƒ½çš„å¹³è¡¡ï¼Œå·²æˆä¸ºLLaMAã€Qwenã€DeepSeekç­‰ä¸»æµå¤§æ¨¡å‹çš„æ ‡å‡†ç»„ä»¶ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸€gqa-çš„ç”±æ¥ä¸ºä»€ä¹ˆéœ€è¦-gqa&#34;&gt;ä¸€ã€GQA çš„ç”±æ¥ï¼šä¸ºä»€ä¹ˆéœ€è¦ GQAï¼Ÿ&lt;/h2&gt;
&lt;p&gt;åœ¨æ ‡å‡†çš„ &lt;strong&gt;Multi-Head Attentionï¼ˆMHAï¼‰&lt;/strong&gt; ä¸­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Queryï¼ˆQï¼‰ã€Keyï¼ˆKï¼‰ã€Valueï¼ˆVï¼‰ éƒ½è¢«åˆ†æˆ &lt;strong&gt;h ä¸ªå¤´&lt;/strong&gt;ï¼Œæ¯ä¸ªå¤´ç‹¬ç«‹è®¡ç®—æ³¨æ„åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;æ¨ç†æ—¶ï¼ŒK å’Œ V éœ€è¦ç¼“å­˜ï¼ˆKV Cacheï¼‰ï¼Œæ€»ç¼“å­˜å¤§å°ä¸ºï¼š&lt;br&gt;
[
\text{Cache Size} = 2 \times h \times n \times d_k
]
å…¶ä¸­ (n) æ˜¯ä¸Šä¸‹æ–‡é•¿åº¦ï¼Œ(d_k) æ˜¯æ¯ä¸ª head çš„ç»´åº¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å½“æ¨¡å‹å˜å¤§ï¼ˆå¦‚ LLaMA-65Bï¼Œh=64ï¼‰ï¼Œ&lt;strong&gt;KV Cache å ç”¨å¤§é‡æ˜¾å­˜&lt;/strong&gt;ï¼Œæˆä¸ºæ¨ç†ç“¶é¢ˆã€‚&lt;/p&gt;
&lt;img src=&#34;GQA.png&#34; alt=&#34;GQA&#34; style=&#34;width:80%;height:auto;&#34;&gt;
&lt;h3 id=&#34;æ›¿ä»£æ–¹æ¡ˆå¯¹æ¯”&#34;&gt;æ›¿ä»£æ–¹æ¡ˆå¯¹æ¯”ï¼š&lt;/h3&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;æ–¹æ³•&lt;/th&gt;
          &lt;th&gt;Q å¤´æ•°&lt;/th&gt;
          &lt;th&gt;K/V å¤´æ•°&lt;/th&gt;
          &lt;th&gt;KV Cache&lt;/th&gt;
          &lt;th&gt;è¡¨è¾¾èƒ½åŠ›&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;MHAï¼ˆå¤šå¤´æ³¨æ„åŠ›ï¼‰&lt;/td&gt;
          &lt;td&gt;h&lt;/td&gt;
          &lt;td&gt;h&lt;/td&gt;
          &lt;td&gt;å¤§&lt;/td&gt;
          &lt;td&gt;å¼º&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;MQAï¼ˆå¤šæŸ¥è¯¢æ³¨æ„åŠ›ï¼‰&lt;/td&gt;
          &lt;td&gt;h&lt;/td&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;æå°&lt;/td&gt;
          &lt;td&gt;å¼±ï¼ˆæ€§èƒ½ä¸‹é™æ˜æ˜¾ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;GQAï¼ˆåˆ†ç»„æŸ¥è¯¢æ³¨æ„åŠ›ï¼‰&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;h&lt;/td&gt;
          &lt;td&gt;gï¼ˆg â‰ª hï¼‰&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;ä¸­ç­‰&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;æ¥è¿‘ MHA&lt;/strong&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ GQA ç”± Google åœ¨ 2023 å¹´è®ºæ–‡ã€Š&lt;a href=&#34;https://arxiv.org/abs/2305.13245&#34;&gt;GQA: Training Generalized Multi-Query Transformer Models from Multi-Head Checkpoints&lt;/a&gt;ã€‹æå‡ºï¼Œæ—¨åœ¨ &lt;strong&gt;å¹³è¡¡æ•ˆç‡ä¸æ€§èƒ½&lt;/strong&gt;ã€‚&lt;/p&gt;</description>
    </item>
    <item>
      <title>YaRN -  æ—‹è½¬ä½ç½®ç¼–ç æ‹“å±•</title>
      <link>http://localhost:1313/llm/architecture/yarn%E6%8E%A8%E7%90%86%E6%89%A9%E5%B1%95%E6%8A%80%E6%9C%AF/</link>
      <pubDate>Thu, 25 Dec 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/llm/architecture/yarn%E6%8E%A8%E7%90%86%E6%89%A9%E5%B1%95%E6%8A%80%E6%9C%AF/</guid>
      <description>&lt;p&gt;æ—‹è½¬ä½ç½®ç¼–ç ï¼ˆRoPE, Rotary Position Embeddingï¼‰æ˜¯ä¸€ç§åœ¨Transformeræ¨¡å‹ä¸­å¼•å…¥ç›¸å¯¹ä½ç½®ä¿¡æ¯ çš„æ–¹æ³•ï¼Œç”±è‹å‰‘æ—ç­‰Credoåœ¨2021å¹´æå‡ºã€‚ç›¸æ¯”ä¼ ç»Ÿçš„ç»å¯¹ä½ç½®ç¼–ç ï¼ˆå¦‚BERTä¸­çš„å¯å­¦ä¹ ä½ç½®åµŒå…¥æˆ–æ­£å¼¦ä½ç½®ç¼–ç ï¼‰ï¼ŒRoPEé€šè¿‡å°†ä½ç½®ä¿¡æ¯ä»¥æ—‹å˜æ¢çš„æ–¹å¼èå…¥æ³¨æ„åŠ›æœºåˆ¶ï¼Œä½¿å¾—æ¨¡å‹å¯ä»¥è‡ªç„¶åœ°æ„ŸçŸ¥ç›¸å¯¹ä½ç½®ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯åœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬å¾€å¾€å‘ç°æœ‰äº›åº”ç”¨éœ€è¦å¤„ç†æ›´é•¿çš„åºåˆ—ï¼Œè€Œæ¨¡å‹åœ¨è®­ç»ƒæ—¶å€™çš„è¾“å…¥åºåˆ—é•¿åº¦å¾€å¾€æœ‰é™ï¼Œè¿™æ—¶RoPEå°±æ— æ³•æ»¡è¶³éœ€æ±‚ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªèƒ½å¤Ÿå°†ä½ç½®ç¼–ç è¿›è¡Œå¤–æ¨çš„æŠ€æœ¯ã€‚YARNï¼ˆYet Another RoPE-based Attention Networkï¼‰æ˜¯ä¸€ç§ç”¨äºæ‰©å±•å¤§è¯­è¨€æ¨¡å‹ä¸Šä¸‹æ–‡é•¿åº¦çš„æŠ€æœ¯ï¼Œå®ƒæ˜¯åœ¨RoPEï¼ˆRotary Position Embeddingï¼‰åŸºç¡€ä¸Šè¿›è¡Œæ”¹è¿›çš„ï¼Œæ—¨åœ¨è®©æ¨¡å‹åœ¨è®­ç»ƒæ—¶ä½¿ç”¨è¾ƒçŸ­ä¸Šä¸‹æ–‡ï¼Œä½†åœ¨æ¨ç†æ—¶èƒ½æœ‰æ•ˆå¤„ç†è¿œè¶…è®­ç»ƒé•¿åº¦çš„è¾“å…¥åºåˆ—ã€‚&lt;/p&gt;
&lt;h2 id=&#34;èƒŒæ™¯ä¸ºä»€ä¹ˆéœ€è¦-yarn&#34;&gt;èƒŒæ™¯ï¼šä¸ºä»€ä¹ˆéœ€è¦ YARNï¼Ÿ&lt;/h2&gt;
&lt;h3 id=&#34;1-ä½ç½®ç¼–ç çš„å¤–æ¨é—®é¢˜&#34;&gt;1. ä½ç½®ç¼–ç çš„å¤–æ¨é—®é¢˜&lt;/h3&gt;
&lt;p&gt;å¤§å¤šæ•°å¤§è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ LLaMAã€ChatGLM ç­‰ï¼‰ä½¿ç”¨ RoPEï¼ˆæ—‹è½¬ä½ç½®ç¼–ç ï¼‰ æ¥æ³¨å…¥ä½ç½®ä¿¡æ¯ã€‚RoPE çš„ä¼˜ç‚¹æ˜¯å…·æœ‰è‰¯å¥½çš„ç›¸å¯¹ä½ç½®å»ºæ¨¡èƒ½åŠ›ï¼Œä½†å…¶ç¼ºç‚¹æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è®­ç»ƒæ—¶æœ€å¤§ä¸Šä¸‹æ–‡é•¿åº¦æœ‰é™&lt;/strong&gt;ï¼ˆæ¯”å¦‚ 2048 æˆ– 4096ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›´æ¥æ¨ç†æ›´é•¿åºåˆ—æ—¶æ€§èƒ½æ€¥å‰§ä¸‹é™&lt;/strong&gt;ï¼ˆå› ä¸º RoPE ä¸­çš„é¢‘ç‡å‚æ•°æœªè¦†ç›–æ›´é•¿è·ç¦»ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;2-å·²æœ‰æ–¹æ³•çš„å±€é™&#34;&gt;2. å·²æœ‰æ–¹æ³•çš„å±€é™&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;NTK-aware scalingï¼ˆNeural Tangent Kernel ç¼©æ”¾ï¼‰&lt;/strong&gt;ï¼šé€šè¿‡ç¼©æ”¾ RoPE çš„ base é¢‘ç‡æ¥â€œæ‹‰ä¼¸â€ä½ç½®ç¼–ç ï¼Œä½†ä¼šç‰ºç‰²çŸ­è·ç¦»ç²¾åº¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;YaRN æå‡ºäº†ä¸€ç§æ›´ç²¾ç»†çš„æ’å€¼ + ç¼©æ”¾ç­–ç•¥&lt;/strong&gt;ï¼Œåœ¨ä¿æŒçŸ­ç¨‹ç²¾åº¦çš„åŒæ—¶æå‡é•¿ç¨‹æ³›åŒ–èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;yarn-çš„æ ¸å¿ƒæ€æƒ³&#34;&gt;YARN çš„æ ¸å¿ƒæ€æƒ³&lt;/h2&gt;
&lt;p&gt;YARN åœ¨ NTK-aware scaling åŸºç¡€ä¸Šå¼•å…¥äº†ä»¥ä¸‹å…³é”®æ”¹è¿›ï¼š&lt;/p&gt;
&lt;h3 id=&#34;1-å±€éƒ¨çª—å£å†…ä¿æŒåŸå§‹-ropeä¸ç¼©æ”¾&#34;&gt;1. å±€éƒ¨çª—å£å†…ä¿æŒåŸå§‹ RoPEï¼ˆä¸ç¼©æ”¾ï¼‰&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;å¯¹äºä½ç½® â‰¤ åŸå§‹è®­ç»ƒé•¿åº¦ï¼ˆå¦‚ 32Kï¼‰ï¼Œä½¿ç”¨åŸå§‹ RoPEï¼Œä¿ç•™é«˜ç²¾åº¦ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;2-å¯¹è¶…å‡ºéƒ¨åˆ†ä½¿ç”¨ç¼©æ”¾åçš„-rope&#34;&gt;2. å¯¹è¶…å‡ºéƒ¨åˆ†ä½¿ç”¨ç¼©æ”¾åçš„ RoPE&lt;/h3&gt;
&lt;p&gt;å¯¹äºä½ç½® &amp;gt; è®­ç»ƒé•¿åº¦ï¼Œä½¿ç”¨ç»è¿‡ç¼©æ”¾çš„ base é¢‘ç‡ï¼ˆç±»ä¼¼ NTK æ–¹æ³•ï¼‰ã€‚&lt;/p&gt;</description>
    </item>
    <item>
      <title>MOE - æ··åˆä¸“å®¶æ¶æ„</title>
      <link>http://localhost:1313/llm/architecture/moe/</link>
      <pubDate>Wed, 24 Dec 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/llm/architecture/moe/</guid>
      <description>&lt;p&gt;æ··åˆä¸“å®¶ï¼ˆMixture of Experts, MoEï¼‰æ˜¯ä¸€ç§**æ¡ä»¶è®¡ç®—ï¼ˆconditional computationï¼‰**æ¶æ„ï¼Œæ—¨åœ¨åœ¨ä¸æ˜¾è‘—å¢åŠ è®¡ç®—æˆæœ¬çš„å‰æä¸‹æ‰©å±•æ¨¡å‹å®¹é‡ã€‚å®ƒå·²è¢«å¹¿æ³›åº”ç”¨äºç°ä»£å¤§è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ Google çš„ GLaMã€Mixtralã€Qwen-MoEã€DeepSeek-MoE ç­‰ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;moe-çš„æ ¸å¿ƒæ€æƒ³&#34;&gt;MoE çš„æ ¸å¿ƒæ€æƒ³&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ğŸ¯ ç›®æ ‡ï¼š
&lt;ul&gt;
&lt;li&gt;æ‰©å¤§æ¨¡å‹å‚æ•°é‡ï¼ˆæå‡è¡¨è¾¾èƒ½åŠ›ï¼‰&lt;/li&gt;
&lt;li&gt;ä¿æŒæ¯æ¬¡å‰å‘è®¡ç®—çš„ FLOPs åŸºæœ¬ä¸å˜ï¼ˆé«˜æ•ˆæ¨ç†ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ğŸ”‘ å…³é”®æœºåˆ¶ï¼š
&lt;ul&gt;
&lt;li&gt;æ¨¡å‹ç”±å¤šä¸ªâ€œä¸“å®¶â€ï¼ˆExpertsï¼‰ç»„æˆï¼Œæ¯ä¸ªä¸“å®¶æ˜¯ä¸€ä¸ªå­ç½‘ç»œï¼ˆå¦‚ FFNï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¼•å…¥ä¸€ä¸ªé—¨æ§ç½‘ç»œï¼ˆGating Networkï¼‰ï¼Œæ ¹æ®è¾“å…¥åŠ¨æ€å†³å®šæ¿€æ´»å“ªå‡ ä¸ªä¸“å®¶ã€‚&lt;/li&gt;
&lt;li&gt;é€šå¸¸åªæ¿€æ´» Top-K ä¸ªä¸“å®¶ï¼ˆå¦‚ K=1 æˆ– K=2ï¼‰ï¼Œå…¶ä½™ä¸“å®¶ä¸å‚ä¸è®¡ç®—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… è¿™æ ·ï¼šæ€»å‚æ•°é‡ = æ‰€æœ‰ä¸“å®¶å‚æ•°ä¹‹å’Œï¼ˆå¾ˆå¤§ï¼‰ï¼Œä½†æ¯ token è®¡ç®—é‡ â‰ˆ K ä¸ªä¸“å®¶ï¼ˆå¾ˆå°ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;moeç»™transformeræ¶æ„å¸¦æ¥çš„æ”¹å˜&#34;&gt;MoEç»™Transformeræ¶æ„å¸¦æ¥çš„æ”¹å˜&lt;/h2&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬ä» Transformer æ¶æ„å‡ºå‘ï¼Œæ·±å…¥è®²è§£ MoEï¼ˆMixture of Expertsï¼‰çš„æ•°å­¦å½¢å¼ã€é—¨æ§æœºåˆ¶æ¥æºã€ä¸“å®¶æ¨¡å—åœ¨ Transformer ä¸­çš„å…·ä½“ä½ç½®ä¸ä½œç”¨&lt;/p&gt;
&lt;h3 id=&#34;moe-åœ¨-transformer-ä¸­çš„ä½ç½®&#34;&gt;MoE åœ¨ Transformer ä¸­çš„ä½ç½®&lt;/h3&gt;
&lt;p&gt;åœ¨æ ‡å‡† Transformer ä¸­ï¼Œæ¯ä¸ª Transformer å±‚åŒ…å«ä¸¤ä¸ªæ ¸å¿ƒå­æ¨¡å—ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¤šå¤´æ³¨æ„åŠ›ï¼ˆMulti-Head Attention, MHAï¼‰&lt;/li&gt;
&lt;li&gt;å‰é¦ˆç½‘ç»œï¼ˆFeed-Forward Network, FFNï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âœ… MoE é€šå¸¸åªæ›¿æ¢ FFN éƒ¨åˆ†ï¼Œè€Œä¿ç•™ MHA ä¸å˜ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ª MoE Transformer å±‚çš„ç»“æ„ä¸ºï¼š&lt;/p&gt;</description>
    </item>
    <item>
      <title>RoPE - æ—‹è½¬ä½ç½®ç¼–ç è§£è¯»</title>
      <link>http://localhost:1313/llm/architecture/rope/</link>
      <pubDate>Fri, 19 Dec 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/llm/architecture/rope/</guid>
      <description>&lt;p&gt;æ—‹è½¬ä½ç½®ç¼–ç ï¼ˆRoPE, Rotary Position Embeddingï¼‰æ˜¯ä¸€ç§åœ¨Transformeræ¨¡å‹ä¸­å¼•å…¥ç›¸å¯¹ä½ç½®ä¿¡æ¯çš„æ–¹æ³•ï¼Œç”±è‹å‰‘æ—ç­‰äººåœ¨2021å¹´æå‡ºã€‚ç›¸æ¯”ä¼ ç»Ÿçš„ç»å¯¹ä½ç½®ç¼–ç ï¼ˆå¦‚BERTä¸­çš„å¯å­¦ä¹ ä½ç½®åµŒå…¥æˆ–æ­£å¼¦ä½ç½®ç¼–ç ï¼‰ï¼ŒRoPEé€šè¿‡å°†ä½ç½®ä¿¡æ¯ä»¥æ—‹è½¬å˜æ¢çš„æ–¹å¼èå…¥æ³¨æ„åŠ›æœºåˆ¶ï¼Œä½¿å¾—æ¨¡å‹å¤©ç„¶å…·å¤‡å¯¹ç›¸å¯¹ä½ç½®çš„æ„ŸçŸ¥èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å›é¡¾åŸå§‹ä½ç½®ç¼–ç &#34;&gt;å›é¡¾åŸå§‹ä½ç½®ç¼–ç &lt;/h2&gt;
&lt;p&gt;åœ¨Transformeræ¨¡å‹ä¸­ï¼Œä½ç½®ç¼–ç ï¼ˆPosition Encodingï¼‰ç”¨äºå°†è¾“å…¥åºåˆ—ä¸­çš„æ¯ä¸ªä½ç½®æ˜ å°„ä¸ºå‘é‡ï¼Œä»¥è¡¨ç¤ºå…¶ç›¸å¯¹ä½ç½®ä¿¡æ¯ã€‚åŸå§‹ä½ç½®ç¼–ç çš„å®ç°æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œå¦‚å¯å­¦ä¹ ä½ç½®åµŒå…¥ï¼ˆLearnable Position Embeddingï¼‰æˆ–æ­£å¼¦ä½ç½®ç¼–ç ï¼ˆSinusoidal Position Encodingï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬çš„è¯æ±‡è¡¨å¤§å°ä¸º&lt;code&gt;[vocab_size, embedding_dim]&lt;/code&gt;ï¼Œè¾“å…¥å¥å­çš„tokené•¿åº¦ä¸º&lt;code&gt;seq_len&lt;/code&gt;ï¼Œæ¯ä¸ªtokenä¼šè¢«è½¬æ¢æˆä¸€ä¸ªvectorå‘é‡ï¼Œç»´åº¦ä¸º&lt;code&gt;[embedding_dim]&lt;/code&gt;ï¼Œåˆ™æ•´ä¸ªè¾“å…¥å¥å­çš„shapeä¸º&lt;code&gt;[ seq_len, embedding_dim]&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œä¸ºäº†è®©æ¨¡å‹ç†è§£åºåˆ—çš„é¡ºåºï¼Œè¿˜éœ€è¦åŠ å…¥ä½ç½®ç¼–ç (Positional Encoding)ã€‚è¿™å°±æ˜¯è‘—åçš„å…¬å¼ï¼š&lt;/p&gt;
&lt;p&gt;$$
PE_{(pos,2i)} = \sin\left(\frac{pos}{10000^{2i/d_{model}}}\right)
$$&lt;/p&gt;
&lt;p&gt;$$
PE_{(pos,2i+1)} = \cos\left(\frac{pos}{10000^{2i/d_{model}}}\right)
$$&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;pos&lt;/code&gt;æ˜¯ä½ç½®ç´¢å¼•ï¼Œå³tokenåœ¨åºåˆ—ä¸­çš„ä½ç½®ï¼Œä»0å¼€å§‹ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;i&lt;/code&gt;æ˜¯ç»´åº¦ç´¢å¼•ï¼Œä»0å¼€å§‹åˆ°$(d_{model}-1)/2$ç»“æŸï¼Œè¡¨ç¤ºè¯åµŒå…¥çš„ç»´åº¦ï¼›&lt;/li&gt;
&lt;li&gt;$d_{model}$æ˜¯è¯åµŒå…¥ï¼ˆword embeddingï¼‰çš„ç»´åº¦&lt;code&gt;embedding_dim&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è§‚å¯Ÿè¾“å…¥å¥å­çš„shape: &lt;code&gt;[seq_len, embedding_dim]&lt;/code&gt;ï¼Œä½ç½®ç¼–ç çš„æ—¶å€™ï¼Œ&lt;code&gt;pos&lt;/code&gt;å¯¹åº”çš„æ˜¯tokenåœ¨&lt;code&gt;seq_len&lt;/code&gt;ç»´åº¦çš„ä½ç½®ï¼Œè€Œç»´åº¦ç´¢å¼•&lt;code&gt;i&lt;/code&gt;å¯¹åº”è¯åµŒå…¥&lt;code&gt;embedding_dim&lt;/code&gt;çš„ç»´åº¦ã€‚&lt;/p&gt;
&lt;p&gt;pytorchä»£ç å®ç°:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;PositionalEncoding&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;max_len&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;pe&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;zeros&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max_len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;position&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arange&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;max_len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsqueeze&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;div_term&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arange&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                            &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tensor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;10000.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;pe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;position&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;div_term&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;pe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;position&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;div_term&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;register_buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pe&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pe&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsqueeze&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;rope-çš„æ ¸å¿ƒæ€æƒ³&#34;&gt;RoPE çš„æ ¸å¿ƒæ€æƒ³&lt;/h2&gt;
&lt;h3 id=&#34;ç›¸å¯¹ä½ç½®-vs-ç»å¯¹ä½ç½®&#34;&gt;ç›¸å¯¹ä½ç½® vs ç»å¯¹ä½ç½®&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨ä¼ ç»ŸTransformerä¸­ï¼Œä½ç½®ç¼–ç æ˜¯åŠ åˆ°è¯åµŒå…¥ä¸Šçš„ï¼ˆå¦‚ x + pos_embï¼‰ï¼Œè¿™ç§æ–¹å¼åªä¿ç•™äº†ç»å¯¹ä½ç½®ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;è€Œ RoPE åˆ™é€šè¿‡å°†æŸ¥è¯¢ï¼ˆQï¼‰å’Œé”®ï¼ˆKï¼‰å‘é‡è¿›è¡Œæ—‹è½¬å˜æ¢ï¼Œä½¿å¾—æ³¨æ„åŠ›åˆ†æ•°è‡ªç„¶åŒ…å«ä¸¤ä¸ª token ä¹‹é—´çš„ç›¸å¯¹è·ç¦»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ—‹è½¬æ“ä½œ&#34;&gt;æ—‹è½¬æ“ä½œ&lt;/h3&gt;
&lt;p&gt;å¯¹äºç»´åº¦ä¸º d çš„å‘é‡ï¼ŒRoPE å°†å…¶åˆ†æˆè‹¥å¹²äºŒç»´å­ç©ºé—´ï¼ˆé€šå¸¸æ˜¯ç›¸é‚»ä¸¤ä¸ªç»´åº¦ä¸€ç»„ï¼‰ï¼Œæ¯ç»„åº”ç”¨ä¸€ä¸ªäºŒç»´æ—‹è½¬çŸ©é˜µï¼š&lt;/p&gt;</description>
    </item>
    <item>
      <title>ä¸€åˆ‡çš„å¼€å§‹ - Transformeræ¶æ„</title>
      <link>http://localhost:1313/llm/architecture/transformer/</link>
      <pubDate>Fri, 19 Dec 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/llm/architecture/transformer/</guid>
      <description>&lt;h2 id=&#34;transformerçš„è¯ç”ŸèƒŒæ™¯&#34;&gt;Transformerçš„è¯ç”ŸèƒŒæ™¯&lt;/h2&gt;
&lt;p&gt;åœ¨æ·±åº¦å­¦ä¹ çš„ä¸–ç•Œé‡Œï¼Œåºåˆ—å»ºæ¨¡ä¸€ç›´æ˜¯ä¸ªè€å¤§éš¾é—®é¢˜ã€‚ä¼ ç»Ÿçš„å¾ªç¯ç¥ç»ç½‘ç»œ(RNN)è™½ç„¶èƒ½å¤Ÿå¤„ç†åºåˆ—æ•°æ®ï¼Œä½†åœ¨å¤„ç†é•¿åºåˆ—æ—¶å­˜åœ¨æ¢¯åº¦æ¶ˆå¤±å’Œè®¡ç®—æ•ˆç‡ä½ä¸‹çš„é—®é¢˜ã€‚è€Œå·ç§¯ç¥ç»ç½‘ç»œ(CNN)è™½ç„¶å¹¶è¡ŒåŒ–ç¨‹åº¦é«˜ï¼Œä½†åœ¨æ•æ‰é•¿è·ç¦»ä¾èµ–å…³ç³»æ–¹é¢åŠ›ä¸ä»å¿ƒã€‚&lt;/p&gt;
&lt;p&gt;å°±åœ¨è¿™ä¸ªå…³é”®æ—¶åˆ»ï¼ŒGoogleçš„å¤§ç¥ä»¬åœ¨2017å¹´æ‰”å‡ºäº†ä¸€ä¸ª&amp;quot;æ ¸å¼¹çº§&amp;quot;çš„è§£å†³æ–¹æ¡ˆâ€”â€”ã€ŠAttention Is All You Needã€‹ã€‚è¿™ç¯‡è®ºæ–‡å½»åº•é¢ è¦†äº†äººä»¬å¯¹åºåˆ—å»ºæ¨¡çš„è®¤çŸ¥ï¼Œæå‡ºäº†å®Œå…¨åŸºäºæ³¨æ„åŠ›æœºåˆ¶çš„Transformeræ¶æ„ã€‚&lt;/p&gt;
&lt;img src=&#34;transformer.png&#34; alt=&#34;transformer&#34; style=&#34;width:60%;height:auto;&#34;&gt;
&lt;h2 id=&#34;ç¿»è¯‘ä»»åŠ¡transformerçš„è¯•éªŒåœº&#34;&gt;ç¿»è¯‘ä»»åŠ¡ï¼šTransformerçš„è¯•éªŒåœº&lt;/h2&gt;
&lt;p&gt;Transformeræœ€åˆæ˜¯ä¸ºäº†æœºå™¨ç¿»è¯‘ä»»åŠ¡è€Œè®¾è®¡çš„ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ è¦æŠŠä¸€å¥ä¸­æ–‡ç¿»è¯‘æˆè‹±æ–‡ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸­æ–‡è¾“å…¥&lt;/strong&gt;: &amp;ldquo;æˆ‘å–œæ¬¢å­¦ä¹ äººå·¥æ™ºèƒ½&amp;rdquo;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è‹±æ–‡è¾“å‡º&lt;/strong&gt;: &amp;ldquo;I like studying artificial intelligence&amp;rdquo;&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹éœ€è¦ç†è§£æ¯ä¸ªè¯çš„å«ä¹‰ï¼Œå¹¶æ‰¾åˆ°å®ƒä»¬ä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚ä¼ ç»Ÿçš„Seq2Seqæ¨¡å‹ä¾èµ–RNNæ¥ç¼–ç è¾“å…¥åºåˆ—ï¼Œä½†æ•ˆæœæœ‰é™ã€‚è€ŒTransformeré€šè¿‡è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œèƒ½å¤ŸåŒæ—¶å…³æ³¨è¾“å…¥åºåˆ—ä¸­çš„æ‰€æœ‰ä½ç½®ï¼Œå¤§å¤§æå‡äº†ç¿»è¯‘è´¨é‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;transformerçš„åŸºæœ¬è¾“å…¥è¾“å‡º&#34;&gt;Transformerçš„åŸºæœ¬è¾“å…¥è¾“å‡º&lt;/h2&gt;
&lt;h3 id=&#34;è¾“å…¥çš„ç§˜å¯†&#34;&gt;è¾“å…¥çš„ç§˜å¯†&lt;/h3&gt;
&lt;p&gt;Transformerçš„è¾“å…¥å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯ä¸€ä¸ªä¸ªtokenï¼ˆå¯ä»¥æ˜¯å•è¯ã€å­è¯æˆ–è€…å­—ç¬¦ï¼‰ã€‚å‡è®¾æˆ‘ä»¬çš„è¯æ±‡è¡¨å¤§å°ä¸º&lt;code&gt;[vocab_size, embedding_dim]&lt;/code&gt;ï¼Œè¾“å…¥å¥å­çš„tokené•¿åº¦ä¸º&lt;code&gt;seq_len&lt;/code&gt;ï¼Œæ¯ä¸ªtokenä¼šè¢«è½¬æ¢æˆä¸€ä¸ªvectorå‘é‡ï¼Œç»´åº¦ä¸º&lt;code&gt;[embedding_dim]&lt;/code&gt;ï¼Œåˆ™æ•´ä¸ªè¾“å…¥å¥å­çš„shapeä¸º&lt;code&gt;[ seq_len, embedding_dim]&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œä¸ºäº†è®©æ¨¡å‹ç†è§£åºåˆ—çš„é¡ºåºï¼Œè¿˜éœ€è¦åŠ å…¥ä½ç½®ç¼–ç (Positional Encoding)ã€‚è¿™å°±æ˜¯è‘—åçš„å…¬å¼ï¼š&lt;/p&gt;
&lt;p&gt;$$
PE_{(pos,2i)} = \sin\left(\frac{pos}{10000^{2i/d_{model}}}\right)
$$&lt;/p&gt;
&lt;p&gt;$$
PE_{(pos,2i+1)} = \cos\left(\frac{pos}{10000^{2i/d_{model}}}\right)
$$&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;pos&lt;/code&gt;æ˜¯ä½ç½®ç´¢å¼•ï¼Œå³tokenåœ¨åºåˆ—ä¸­çš„ä½ç½®ï¼Œä»0å¼€å§‹ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;i&lt;/code&gt;æ˜¯ç»´åº¦ç´¢å¼•ï¼Œä»0å¼€å§‹åˆ°$d_{model}-1$ç»“æŸï¼Œè¡¨ç¤ºè¯åµŒå…¥çš„ç»´åº¦ï¼›&lt;/li&gt;
&lt;li&gt;$d_{model}$æ˜¯è¯åµŒå…¥ï¼ˆword embeddingï¼‰çš„ç»´åº¦&lt;code&gt;embedding_dim&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è§‚å¯Ÿè¾“å…¥å¥å­çš„shape: &lt;code&gt;[seq_len, embedding_dim]&lt;/code&gt;ï¼Œä½ç½®ç¼–ç çš„æ—¶å€™ï¼Œ&lt;code&gt;pos&lt;/code&gt;å¯¹åº”çš„æ˜¯tokenåœ¨&lt;code&gt;seq_len&lt;/code&gt;ç»´åº¦çš„ä½ç½®ï¼Œè€Œç»´åº¦ç´¢å¼•&lt;code&gt;i&lt;/code&gt;å¯¹åº”è¯åµŒå…¥&lt;code&gt;embedding_dim&lt;/code&gt;çš„ç»´åº¦ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è¾“å‡ºçš„é­…åŠ›&#34;&gt;è¾“å‡ºçš„é­…åŠ›&lt;/h3&gt;
&lt;p&gt;Transformerçš„è¾“å‡ºåŒæ ·æ˜¯ä¸€ç³»åˆ—tokenï¼Œä½†å®ƒè¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šä¹‹å¤„â€”â€”å®ƒæ˜¯ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒã€‚å¯¹äºæ¯ä¸ªæ—¶é—´æ­¥ï¼Œæ¨¡å‹ä¼šè¾“å‡ºè¯æ±‡è¡¨ä¸­æ¯ä¸ªè¯çš„æ¦‚ç‡ï¼Œç„¶åé€šè¿‡è´ªå©ªæœç´¢æˆ–æŸæœç´¢æ¥é€‰æ‹©æœ€åˆé€‚çš„è¯ã€‚è¿™äº›æœç´¢ç®—æ³•æ„æˆäº†æ¨ç†æ—¶æ‰©å±•ç®—æ³•çš„åŸºç¡€ã€‚&lt;/p&gt;
&lt;p&gt;è¡¥å……è´ªå©ªæœç´¢å’ŒæŸæœç´¢çš„ç®—æ³•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è´ªå©ªæœç´¢æ˜¯ä¸€ç§ç®€å•ç›´æ¥çš„è§£ç ç­–ç•¥ã€‚åœ¨æ¯ä¸ªæ—¶é—´æ­¥ï¼Œå®ƒæ€»æ˜¯é€‰æ‹©å…·æœ‰æœ€é«˜æ¦‚ç‡çš„tokenä½œä¸ºä¸‹ä¸€ä¸ªè¾“å‡ºï¼Œä¸è€ƒè™‘åç»­å¯èƒ½çš„å½±å“ã€‚ä¼˜ç‚¹æ˜¯è®¡ç®—ç®€å•ï¼Œé€Ÿåº¦å¿«ï¼Œå†…å­˜å ç”¨å°‘ï¼›ç¼ºç‚¹åˆ™æ˜¯å®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜ï¼Œç”Ÿæˆç»“æœç¼ºä¹å¤šæ ·æ€§ã€‚&lt;/li&gt;
&lt;li&gt;æŸæœç´¢æ˜¯å¯¹è´ªå©ªæœç´¢çš„æ”¹è¿›ï¼Œåœ¨æ¯ä¸ªæ—¶é—´æ­¥ä¿ç•™beam_widthä¸ªæœ€æœ‰å¸Œæœ›çš„å€™é€‰åºåˆ—ï¼Œè€Œä¸æ˜¯åªä¿ç•™ä¸€ä¸ªã€‚ç›¸æ¯”è´ªå©ªæœç´¢èƒ½æ‰¾åˆ°æ›´ä¼˜çš„åºåˆ—ï¼Œåœ¨åˆç†çš„æ—¶é—´å†…æ¢ç´¢å¤šä¸ªå¯èƒ½æ€§ï¼›ç¼ºç‚¹åˆ™æ˜¯è®¡ç®—å¤æ‚åº¦è¾ƒé«˜ï¼Œéœ€è¦è°ƒæ•´beam_widthå‚æ•°ï¼Œä»å¯èƒ½é”™è¿‡å…¨å±€æœ€ä¼˜è§£ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æ ¸å¿ƒæ¨¡å—encoderå’Œdecoder&#34;&gt;æ ¸å¿ƒæ¨¡å—ï¼šEncoderå’ŒDecoder&lt;/h2&gt;
&lt;p&gt;Transformerçš„æ ¸å¿ƒç”±ä¸¤å¤§éƒ¨åˆ†ç»„æˆï¼š&lt;code&gt;Encoder&lt;/code&gt;å’Œ&lt;code&gt;Decoder&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;encoderä¿¡æ¯çš„åŠ å·¥å‚&#34;&gt;Encoderï¼šä¿¡æ¯çš„åŠ å·¥å‚&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;Encoder&lt;/code&gt;è´Ÿè´£å°†è¾“å…¥åºåˆ—è½¬æ¢æˆä¸€ç³»åˆ—éšè—è¡¨ç¤ºã€‚å®ƒç”±Nä¸ªç›¸åŒçš„å±‚å †å è€Œæˆï¼Œæ¯ä¸€å±‚éƒ½åŒ…å«ä¸¤ä¸ªå­å±‚ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶(Multi-Head Self-Attention)&lt;/li&gt;
&lt;li&gt;ä½ç½®å…¨è¿æ¥å‰é¦ˆç½‘ç»œ(Position-wise Feed-Forward Networks)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ¯å±‚éƒ½æœ‰æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–ï¼Œè¿™ä½¿å¾—æ·±å±‚ç½‘ç»œä¹Ÿèƒ½ç¨³å®šè®­ç»ƒã€‚&lt;/p&gt;
&lt;h3 id=&#34;decoderåˆ›ä½œçš„è‰ºæœ¯å®¶&#34;&gt;Decoderï¼šåˆ›ä½œçš„è‰ºæœ¯å®¶&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;Decoder&lt;/code&gt;åˆ™è´Ÿè´£æ ¹æ®&lt;code&gt;Encoder&lt;/code&gt;çš„è¾“å‡ºå’Œä¹‹å‰ç”Ÿæˆçš„tokenæ¥é¢„æµ‹ä¸‹ä¸€ä¸ªtokenã€‚å®ƒçš„ç»“æ„æ¯”&lt;code&gt;Encoder&lt;/code&gt;ç¨å¤æ‚ä¸€äº›ï¼ŒåŒ…å«ä¸‰ä¸ªå­å±‚ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ©ç å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶(Masked Multi-Head Self-Attention)&lt;/li&gt;
&lt;li&gt;å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶(Multi-Head Attention)&lt;/li&gt;
&lt;li&gt;ä½ç½®å…¨è¿æ¥å‰é¦ˆç½‘ç»œ(Position-wise Feed-Forward Networks)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å…¶ä¸­æ©ç æœºåˆ¶ç¡®ä¿åœ¨ç”Ÿæˆå½“å‰ä½ç½®çš„è¾“å‡ºæ—¶ï¼Œåªèƒ½çœ‹åˆ°ä¹‹å‰çš„ä½ç½®ï¼Œä¸èƒ½&amp;quot;å·çœ‹&amp;quot;æœªæ¥çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åŸºæœ¬ç»„ä»¶è¯¦è§£&#34;&gt;åŸºæœ¬ç»„ä»¶è¯¦è§£&lt;/h2&gt;
&lt;p&gt;ç°åœ¨è®©æˆ‘ä»¬æ·±å…¥äº†è§£ä¸€ä¸‹Transformerå†…éƒ¨çš„å„ä¸ªç»„ä»¶ï¼š&lt;/p&gt;</description>
    </item>
    <item>
      <title>ç»¼è¿° - Transformeræ¶æ„çš„æ¼”è¿›</title>
      <link>http://localhost:1313/llm/architecture/transformer%E6%9E%B6%E6%9E%84%E7%9A%84%E6%BC%94%E8%BF%9B/</link>
      <pubDate>Fri, 19 Dec 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/llm/architecture/transformer%E6%9E%B6%E6%9E%84%E7%9A%84%E6%BC%94%E8%BF%9B/</guid>
      <description>&lt;h2 id=&#34;transformeræ¶æ„æ¼”è¿›ä»è‡ªæ³¨æ„åŠ›åˆ°é•¿åºåˆ—ä¸å¤šæ¨¡æ€çš„é©å‘½æ€§çªç ´&#34;&gt;Transformeræ¶æ„æ¼”è¿›ï¼šä»è‡ªæ³¨æ„åŠ›åˆ°é•¿åºåˆ—ä¸å¤šæ¨¡æ€çš„é©å‘½æ€§çªç ´&lt;/h2&gt;
&lt;p&gt;Transformerè‡ª2017å¹´æå‡ºä»¥æ¥ï¼Œå·²æˆä¸ºæ·±åº¦å­¦ä¹ é¢†åŸŸçš„åŸºçŸ³æ¶æ„ï¼Œå…¶æ¼”è¿›å†ç¨‹åæ˜ äº†AIç ”ç©¶è€…å¯¹è®¡ç®—æ•ˆç‡ã€é•¿åºåˆ—å¤„ç†èƒ½åŠ›å’Œè·¨æ¨¡æ€åº”ç”¨çš„ä¸æ‡ˆè¿½æ±‚ã€‚&lt;strong&gt;ä»æœ€åˆçš„O(nÂ²)è®¡ç®—å¤æ‚åº¦åˆ°å¦‚ä»Šçš„O(n)çº¿æ€§å¤æ‚åº¦ï¼Œä»å•æ¨¡æ€æ–‡æœ¬å¤„ç†åˆ°åŸç”Ÿå¤šæ¨¡æ€æ¶æ„ï¼ŒTransformerçš„æ¼”è¿›ä¸ä»…è§£å†³äº†è‡ªèº«å±€é™ï¼Œæ›´æ¨åŠ¨äº†å¤§è¯­è¨€æ¨¡å‹ã€è§†è§‰æ¨¡å‹å’Œå¤šæ¨¡æ€ç³»ç»Ÿçš„é©å‘½æ€§å‘å±•&lt;/strong&gt;ã€‚è¿™äº›æ¼”è¿›ä¸»è¦ä½“ç°åœ¨æ³¨æ„åŠ›æœºåˆ¶åˆ›æ–°ã€ä½ç½®ç¼–ç æ”¹è¿›ã€æ¨¡å‹æ¶æ„å˜ä½“ä¸æ‰©å±•ã€è®­ç»ƒæ¨ç†æ•ˆç‡ä¼˜åŒ–å››å¤§æ–¹å‘ï¼Œå…±åŒæ„å»ºäº†ç°ä»£AIç³»ç»Ÿçš„è®¡ç®—åŸºç¡€ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¸€æ³¨æ„åŠ›æœºåˆ¶çš„æ¼”è¿›ä»å…¨å±€åˆ°ç¨€ç–å†åˆ°çŠ¶æ€ç©ºé—´æ¨¡å‹&#34;&gt;ä¸€ã€æ³¨æ„åŠ›æœºåˆ¶çš„æ¼”è¿›ï¼šä»å…¨å±€åˆ°ç¨€ç–å†åˆ°çŠ¶æ€ç©ºé—´æ¨¡å‹&lt;/h3&gt;
&lt;p&gt;TransformeråŸå§‹æ¶æ„çš„æ ¸å¿ƒæ˜¯è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œå®ƒé€šè¿‡è®¡ç®—æŸ¥è¯¢(Q)ã€é”®(K)å’Œå€¼(V)ä¹‹é—´çš„ç›¸ä¼¼åº¦æ¥æ•æ‰åºåˆ—å†…éƒ¨çš„é•¿è·ç¦»ä¾èµ–å…³ç³»  ã€‚æ ‡å‡†è‡ªæ³¨æ„åŠ›çš„è®¡ç®—å…¬å¼ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;$$
\text{Attention}(Q,K,V) = \text{softmax}\left( \frac{QK^\top}{\sqrt{d_k}} \right)V
$$&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼Œ$Qâˆˆâ„^{nÃ—d_k}$ï¼Œ$Kâˆˆâ„^{nÃ—d_k}$ï¼Œ$Vâˆˆâ„^{nÃ—d_v}$ï¼Œd_kæ˜¯é”®å‘é‡çš„ç»´åº¦ã€‚è¿™ä¸€æœºåˆ¶è™½ç„¶å¼ºå¤§ï¼Œä½†è®¡ç®—å¤æ‚åº¦ä¸ºO(nÂ²)ï¼Œéšç€åºåˆ—é•¿åº¦nçš„å¢åŠ å‘ˆå¹³æ–¹å¢é•¿ï¼Œä¸¥é‡é™åˆ¶äº†å¤„ç†é•¿æ–‡æœ¬çš„èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºè§£å†³è¿™ä¸€ç“¶é¢ˆï¼Œç ”ç©¶è€…ä»å¤šä¸ªè§’åº¦å¯¹æ³¨æ„åŠ›æœºåˆ¶è¿›è¡Œäº†åˆ›æ–°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1. ç¨€ç–æ³¨æ„åŠ›æœºåˆ¶&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç¨€ç–æ³¨æ„åŠ›é€šè¿‡é™åˆ¶æ¯ä¸ªtokenåªèƒ½å…³æ³¨åºåˆ—ä¸­çš„å±€éƒ¨åŒºåŸŸï¼Œå°†è®¡ç®—å¤æ‚åº¦ä»O(nÂ²)é™è‡³O(n)ã€‚ä¸»è¦ä»£è¡¨åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Longformer&lt;/strong&gt;ï¼šé‡‡ç”¨æ»‘åŠ¨çª—å£æ³¨æ„åŠ›æœºåˆ¶ï¼Œæ¯ä¸ªtokenä»…å…³æ³¨å…¶å‘¨å›´å›ºå®šçª—å£å†…çš„tokenï¼ŒåŒæ—¶ä¿ç•™å°‘æ•°å…¨å±€tokenä»¥ç»´æŒä¸Šä¸‹æ–‡è¿è´¯æ€§  ã€‚å…¶çª—å£æ³¨æ„åŠ›å…¬å¼ä¸ºï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;$$
\text{WindowAttention}(Q,K,V) = \text{softmax}\left( \frac{QK^\top}{\sqrt{d_k}} \right)V_{\text{window}}
$$&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼ŒV_windowæ˜¯çª—å£å†…å€¼å‘é‡çš„å­é›†ï¼Œçª—å£å¤§å°é€šå¸¸ä¸º512æˆ–1024ä¸ªtoken  ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;BigBird&lt;/strong&gt;ï¼šç»“åˆä¸‰ç§æ³¨æ„åŠ›æ¨¡å¼â€”â€”éšæœºæ³¨æ„åŠ›ï¼ˆé€šè¿‡ErdÅ‘s-RÃ©nyiå›¾é‡‡æ ·ï¼‰ã€æ»‘åŠ¨çª—å£æ³¨æ„åŠ›å’Œå…¨å±€æ³¨æ„åŠ›  ã€‚éšæœºæ³¨æ„åŠ›ä½¿æ¨¡å‹èƒ½å¤Ÿæ•æ‰é•¿è·ç¦»ä¾èµ–ï¼ŒåŒæ—¶ä¿æŒO(n)çš„çº¿æ€§å¤æ‚åº¦ã€‚å…¶éšæœºæ³¨æ„åŠ›çŸ©é˜µå¯ä»¥è¡¨ç¤ºä¸ºï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;$$
\text{RandomAttention}(Q,K,V) = \text{softmax}\left( \frac{QW_{\text{random}}K^\top}{\sqrt{d_k}} \right)V_{\text{random}}
$$&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼Œ$W_{random}$æ˜¯éšæœºæ©ç çŸ©é˜µï¼Œ$V_{random}$æ˜¯éšæœºé‡‡æ ·å€¼å‘é‡çš„å­é›†  ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å±€éƒ¨å¢å¼ºMambaï¼ˆLEVMï¼‰&lt;/strong&gt;ï¼šåœ¨Mambaæ¶æ„ä¸­ï¼Œé€šè¿‡åŠ¨æ€é€‰æ‹©æ€§å¤„ç†ï¼Œå¯¹é‡è¦ä¿¡æ¯ä¿ç•™å®Œæ•´çŠ¶æ€ï¼Œå¯¹ä¸é‡è¦ä¿¡æ¯è¿›è¡Œå‹ç¼©ï¼Œå®ç°O(n)è®¡ç®—å¤æ‚åº¦å’ŒO(1)æ˜¾å­˜å ç”¨  ã€‚å…¶æ ¸å¿ƒçŠ¶æ€æ–¹ç¨‹ä¸ºï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;$$
h_t = \overline{A}h_{t-1} + \overline{B}x_t
$$&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼Œ$\overline{A}$å’Œ$\overline{B}$æ˜¯åŠ¨æ€ç”Ÿæˆçš„å‚æ•°çŸ©é˜µï¼Œå…è®¸æ¨¡å‹æ ¹æ®è¾“å…¥é€‰æ‹©æ€§åœ°ä¿ç•™ä¿¡æ¯  ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. çº¿æ€§æ³¨æ„åŠ›æœºåˆ¶&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;çº¿æ€§æ³¨æ„åŠ›é€šè¿‡æ•°å­¦è¿‘ä¼¼æŠ€æœ¯ï¼Œå°†æ³¨æ„åŠ›è®¡ç®—çš„å¤æ‚åº¦é™è‡³O(n)ï¼ŒåŒæ—¶ä¿æŒæ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ã€‚ä¸»è¦ä»£è¡¨åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Performer&lt;/strong&gt;ï¼šé‡‡ç”¨æ ¸å‡½æ•°è¿‘ä¼¼æ–¹æ³•ï¼Œå°†æ ‡å‡†æ³¨æ„åŠ›å…¬å¼ä¸­çš„softmax(QKáµ€)æ›¿æ¢ä¸ºæ ¸å‡½æ•°K(Q,K)ï¼Œä½¿å¾—è®¡ç®—å¯ä»¥åˆ†è§£ä¸ºO(n)çš„çº¿æ€§æ“ä½œ  ã€‚å…¶æ ¸å¿ƒå…¬å¼ä¸ºï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;$$
\text{LinearAttention}(Q,K,V) = \text{æ ¸å‡½æ•°}(Q,K)V
$$&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼Œæ ¸å‡½æ•°å¯ä»¥æ˜¯é«˜æ–¯æ ¸ã€å¤šé¡¹å¼æ ¸æˆ–å…¶ä»–ç±»å‹çš„æ ¸å‡½æ•°  ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Mamba&lt;/strong&gt;ï¼šå°†æ³¨æ„åŠ›æœºåˆ¶æ›¿æ¢ä¸ºç»“æ„åŒ–çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆSSMï¼‰ï¼Œé€šè¿‡é€’å½’è®¡ç®—å®ç°é•¿åºåˆ—å¤„ç†  ã€‚Mambaåœ¨S4çš„åŸºç¡€ä¸Šæ”¹è¿›ï¼Œå¼•å…¥é€‰æ‹©æ€§å¤„ç†æœºåˆ¶ï¼Œå…è®¸æ¨¡å‹æ ¹æ®è¾“å…¥åŠ¨æ€ç”Ÿæˆå‚æ•°$\overline{A}$, $\overline{B}$, Î”ï¼Œä»è€Œå®ç°å¯¹ä¿¡æ¯çš„é€‰æ‹©æ€§ä¿ç•™å’Œå‹ç¼©  ã€‚å…¶çŠ¶æ€æ–¹ç¨‹ä¸ºï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;$$
h_t = \overline{A}h_{t-1} + \overline{B}x_t,\quad y_t = Ch_t
$$&lt;/p&gt;</description>
    </item>
    <item>
      <title>KV cache - å¤§æ¨¡å‹é«˜æ•ˆæ¨ç†çš„åŸºçŸ³</title>
      <link>http://localhost:1313/llm/architecture/kv-cache/</link>
      <pubDate>Mon, 13 Jan 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/llm/architecture/kv-cache/</guid>
      <description>&lt;p&gt;KV Cacheï¼ˆKey-Value Cacheï¼‰æ˜¯å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLM, Large Language Modelï¼‰æ¨ç†è¿‡ç¨‹ä¸­ç”¨äº&lt;strong&gt;åŠ é€Ÿè‡ªå›å½’ç”Ÿæˆ&lt;/strong&gt;çš„ä¸€é¡¹å…³é”®æŠ€æœ¯ã€‚å®ƒé€šè¿‡ç¼“å­˜å…ˆå‰ token çš„ Key å’Œ Value å‘é‡ï¼Œé¿å…åœ¨ç”Ÿæˆæ–° token æ—¶é‡å¤è®¡ç®—å·²å¤„ç†ä¸Šä¸‹æ–‡çš„æ³¨æ„åŠ›ä¿¡æ¯ï¼Œä»è€Œæ˜¾è‘—æå‡æ¨ç†æ•ˆç‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸€ä¸ºä»€ä¹ˆéœ€è¦-kv-cache&#34;&gt;ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ KV Cacheï¼Ÿ&lt;/h2&gt;
&lt;h3 id=&#34;1-è‡ªå›å½’ç”Ÿæˆçš„æœ¬è´¨&#34;&gt;1. è‡ªå›å½’ç”Ÿæˆçš„æœ¬è´¨&lt;/h3&gt;
&lt;p&gt;å¤§è¯­è¨€æ¨¡å‹é€šå¸¸ä»¥&lt;strong&gt;è‡ªå›å½’æ–¹å¼&lt;/strong&gt;ç”Ÿæˆæ–‡æœ¬ï¼šæ¯æ¬¡åªé¢„æµ‹ä¸€ä¸ª tokenï¼Œç„¶åå°†è¯¥ token æ‹¼æ¥åˆ°è¾“å…¥åºåˆ—æœ«å°¾ï¼Œå†é¢„æµ‹ä¸‹ä¸€ä¸ª tokenã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;è¾“å…¥: &amp;#34;ä»Šå¤©å¤©æ°”&amp;#34;
ç¬¬1æ­¥è¾“å‡º: &amp;#34;çœŸ&amp;#34;
è¾“å…¥å˜ä¸º: &amp;#34;ä»Šå¤©å¤©æ°”çœŸ&amp;#34;
ç¬¬2æ­¥è¾“å‡º: &amp;#34;å¥½&amp;#34;
...
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;2-æ³¨æ„åŠ›æœºåˆ¶çš„é‡å¤è®¡ç®—é—®é¢˜&#34;&gt;2. æ³¨æ„åŠ›æœºåˆ¶çš„é‡å¤è®¡ç®—é—®é¢˜&lt;/h3&gt;
&lt;p&gt;Transformer ä½¿ç”¨ &lt;strong&gt;è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆSelf-Attentionï¼‰&lt;/strong&gt;ï¼Œå¯¹é•¿åº¦ä¸º $n$ çš„åºåˆ—ï¼Œæ¯ä¸ª token éƒ½è¦ä¸å…¶ä»–æ‰€æœ‰ token è®¡ç®—æ³¨æ„åŠ›æƒé‡ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾å½“å‰å·²ç”Ÿæˆ $t$ ä¸ª tokenï¼Œç°åœ¨è¦ç”Ÿæˆç¬¬ $t+1$ ä¸ª tokenã€‚è‹¥æ¯æ¬¡éƒ½é‡æ–°è®¡ç®—æ•´ä¸ªé•¿åº¦ä¸º $t+1$ çš„åºåˆ—çš„ Qã€Kã€Vï¼Œé‚£ä¹ˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬1æ­¥ï¼šè®¡ç®—1ä¸ªtoken â†’ 1æ¬¡QKV&lt;/li&gt;
&lt;li&gt;ç¬¬2æ­¥ï¼šè®¡ç®—2ä¸ªtoken â†’ 2æ¬¡QKVï¼ˆä½†å‰1ä¸ªå…¶å®å·²ç»ç®—è¿‡ï¼‰&lt;/li&gt;
&lt;li&gt;&amp;hellip;&lt;/li&gt;
&lt;li&gt;ç¬¬$t$æ­¥ï¼šè®¡ç®—$t$ä¸ªtoken â†’ å‰$t-1$ä¸ªé‡å¤è®¡ç®—ï¼&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™å¯¼è‡´ &lt;strong&gt;æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2)$&lt;/strong&gt;ï¼Œä¸”å¤§é‡é‡å¤è®¡ç®—ã€‚&lt;/p&gt;
&lt;h3 id=&#34;3-kv-cache-çš„æå‡º&#34;&gt;3. KV Cache çš„æå‡º&lt;/h3&gt;
&lt;p&gt;ä¸ºè§£å†³æ­¤é—®é¢˜ï¼Œç ”ç©¶è€…æå‡ºï¼š&lt;strong&gt;åœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­ç¼“å­˜æ¯ä¸ª token å¯¹åº”çš„ Kï¼ˆKeyï¼‰å’Œ Vï¼ˆValueï¼‰å‘é‡&lt;/strong&gt;ã€‚å› ä¸ºï¼š&lt;/p&gt;</description>
    </item>
    <item>
      <title>GDN - Qwen3-Nextä¸­å¼•å…¥çš„ä¸€ç§çŠ¶æ€ç©ºé—´æ¨¡å‹å˜ä½“</title>
      <link>http://localhost:1313/llm/architecture/gdn/</link>
      <pubDate>Thu, 09 Jan 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/llm/architecture/gdn/</guid>
      <description>&lt;p&gt;Ref: &lt;a href=&#34;https://zhuanlan.zhihu.com/p/1970797248171475540&#34;&gt;çŸ¥ä¹&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Gated DeltaNet æ˜¯ Qwen3-Nextï¼ˆé€šä¹‰åƒé—® 3 çš„ä¸‹ä¸€ä»£æ¨¡å‹ï¼‰ä¸­å¼•å…¥çš„ä¸€ç§&lt;strong&gt;çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆState Space Model, SSMï¼‰å˜ä½“&lt;/strong&gt;ï¼Œç”¨äºå¢å¼º Transformer æ¶æ„åœ¨é•¿åºåˆ—å»ºæ¨¡ä¸­çš„èƒ½åŠ›ã€‚å®ƒèåˆäº† &lt;strong&gt;Delta Ruleï¼ˆå¢é‡å­¦ä¹ è§„åˆ™ï¼‰&lt;/strong&gt;ã€&lt;strong&gt;é—¨æ§æœºåˆ¶ï¼ˆGatingï¼‰&lt;/strong&gt; å’Œ &lt;strong&gt;çŠ¶æ€ç©ºé—´å»ºæ¨¡æ€æƒ³&lt;/strong&gt;ï¼Œæ—¨åœ¨è§£å†³ä¼ ç»Ÿæ³¨æ„åŠ›æœºåˆ¶åœ¨å¤„ç†è¶…é•¿ä¸Šä¸‹æ–‡æ—¶çš„è®¡ç®—å’Œå†…å­˜ç“¶é¢ˆã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬å°†ä»&lt;strong&gt;ç”±æ¥ã€æ¼”å˜ã€é›†æˆæ–¹å¼ã€æ•°å­¦å½¢å¼&lt;/strong&gt;åˆ° &lt;strong&gt;PyTorch å®ç°&lt;/strong&gt; ä¸€æ­¥æ­¥è§£æ Gated DeltaNetã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;ä¸€ç”±æ¥ä¸åŠ¨æœº&#34;&gt;ä¸€ã€ç”±æ¥ä¸åŠ¨æœº&lt;/h2&gt;
&lt;h3 id=&#34;11-èƒŒæ™¯transformer-çš„å±€é™&#34;&gt;1.1 èƒŒæ™¯ï¼šTransformer çš„å±€é™&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ ‡å‡† Transformer ä½¿ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œå…¶å¤æ‚åº¦ä¸º $O(L^2)$ï¼Œå…¶ä¸­ $L$ æ˜¯åºåˆ—é•¿åº¦ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºè¶…é•¿ä¸Šä¸‹æ–‡ï¼ˆå¦‚ 100K+ tokensï¼‰ï¼Œæ³¨æ„åŠ›æœºåˆ¶å˜å¾—ä¸å¯æ‰©å±•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;12-çŠ¶æ€ç©ºé—´æ¨¡å‹ssmçš„å…´èµ·&#34;&gt;1.2 çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆSSMï¼‰çš„å…´èµ·&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;SSMï¼ˆå¦‚ S4ã€S5ã€Mambaï¼‰æä¾›äº†ä¸€ç§çº¿æ€§å¤æ‚åº¦ $O(L)$ çš„åºåˆ—å»ºæ¨¡èŒƒå¼ã€‚&lt;/li&gt;
&lt;li&gt;å…¶æ ¸å¿ƒæ˜¯ç»´æŠ¤ä¸€ä¸ª&lt;strong&gt;éšçŠ¶æ€&lt;/strong&gt; $h_t$ï¼Œé€šè¿‡é€’æ¨æ›´æ–°ï¼š
$$
h_t = \bar{A} h_{t-1} + \bar{B} x_t
$$
$$
y_t = C h_t
$$
å…¶ä¸­ $\bar{A}, \bar{B}$ æ˜¯ç¦»æ•£åŒ–åçš„ç³»ç»ŸçŸ©é˜µã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;13-delta-rule-ä¸-hebbian-å­¦ä¹ &#34;&gt;1.3 Delta Rule ä¸ Hebbian å­¦ä¹ &lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Delta Rule æ˜¯ä¸€ç§å¢é‡å­¦ä¹ è§„åˆ™ï¼Œå½¢å¼ä¸ºï¼š
$$
\Delta W \propto (y_{\text{target}} - y) x^\top
$$&lt;/li&gt;
&lt;li&gt;åœ¨ç¥ç»è®°å¿†æ¨¡å‹ä¸­ï¼ŒDelta Rule å¯è¢«è§£é‡Šä¸º&lt;strong&gt;å¿«é€Ÿè”æƒ³è®°å¿†æ›´æ–°&lt;/strong&gt;ï¼šæ–°è¾“å…¥ $x_t$ ä¸å½“å‰è¾“å‡ºè¯¯å·®å…±åŒé©±åŠ¨æƒé‡æ›´æ–°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;14-gated-deltanet-çš„æå‡º&#34;&gt;1.4 Gated DeltaNet çš„æå‡º&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Gated DeltaNet å°† Delta Rule çš„æ€æƒ³åµŒå…¥åˆ° SSM æ¡†æ¶ä¸­ï¼Œå½¢æˆä¸€ç§&lt;strong&gt;å¯å­¦ä¹ çš„ã€é—¨æ§æ§åˆ¶çš„è®°å¿†æ›´æ–°æœºåˆ¶&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å®ƒä¸æ˜¯ç›´æ¥æ›´æ–°æƒé‡ï¼Œè€Œæ˜¯ç»´æŠ¤ä¸€ä¸ª&lt;strong&gt;é”®å€¼è®°å¿†çŸ©é˜µ&lt;/strong&gt; $M_t$ï¼Œå¹¶é€šè¿‡é—¨æ§æœºåˆ¶è¿›è¡Œå¢é‡æ›´æ–°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;äºŒgated-deltanet-çš„æ•°å­¦å½¢å¼&#34;&gt;äºŒã€Gated DeltaNet çš„æ•°å­¦å½¢å¼&lt;/h2&gt;
&lt;p&gt;Gated DeltaNet çš„æ ¸å¿ƒæ˜¯ç»´æŠ¤ä¸€ä¸ª&lt;strong&gt;å¤–éƒ¨è®°å¿†çŸ©é˜µ&lt;/strong&gt; $M_t \in \mathbb{R}^{d_k \times d_v}$ï¼Œå¹¶åœ¨æ¯ä¸ªæ—¶é—´æ­¥é€šè¿‡è¾“å…¥ $x_t$ æ›´æ–°å®ƒã€‚&lt;/p&gt;</description>
    </item>
    <item>
      <title>mHC - Manifold-Constrained Hyper-Connections æµå½¢çº¦æŸè¶…é“¾æ¥</title>
      <link>http://localhost:1313/llm/architecture/mhc/</link>
      <pubDate>Wed, 08 Jan 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/llm/architecture/mhc/</guid>
      <description>&lt;p&gt;Ref: &lt;a href=&#34;https://arxiv.org/abs/2512.24880v1&#34;&gt;mHC: Manifold-Constrained Hyper-Connections &lt;/a&gt;&lt;/p&gt;
&lt;img src=&#34;mHC.jpg&#34; alt=&#34;mHC&#34; style=&#34;width:80%;height:auto;&#34;&gt;
&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;è‡ªä»ResNetsçš„æå‡ºï¼Œæ·±åº¦ç¥ç»ç½‘ç»œæ¶æ„ç»å†äº†å¿«é€Ÿçš„æ¼”è¿›ã€‚ä¸€ä¸ªå¸¸è§„çš„ResNetå±‚ç»“æœå¦‚ä¸Šé¢å›¾(a)æ‰€ç¤ºï¼Œå…¶æ•°å­¦è¡¨è¾¾å¼æè¿°ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;$$
\mathbf{x}_{l+1} = \mathbf{x}_l + \mathcal{F}(\mathbf{x}_l, W_l)             \tag{1}
$$&lt;/p&gt;
&lt;p&gt;å…¶ä¸­$\mathbf{x}&lt;em&gt;l$å’Œ$\mathbf{x}&lt;/em&gt;{l+1}$è¡¨ç¤ºè¾“å…¥å’Œè¾“å‡ºå‘é‡ï¼Œæ˜¯ä¸€ä¸ª$C$ç»´åº¦çš„å‘é‡ã€‚$\mathcal{F}$è¡¨ç¤ºæ®‹å·®å‡½æ•°ï¼Œ$W_l$è¡¨ç¤ºæƒé‡çŸ©é˜µã€‚å°½ç®¡æ®‹å·®å‡½æ•°Fåœ¨è¿‡å»åå¹´ä¸­å·²å‘å±•å‡ºå·ç§¯ã€æ³¨æ„åŠ›æœºåˆ¶å’Œå‰é¦ˆç½‘ç»œç­‰å¤šç§æ“ä½œï¼Œä½†æ®‹å·®è¿æ¥çš„èŒƒå¼ä»ä¿æŒå…¶åŸå§‹å½¢å¼ã€‚éšç€Transformeræ¶æ„çš„å‘å±•ï¼Œè¯¥èŒƒå¼ç›®å‰å·²ç¡®ç«‹ä¸ºå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰çš„åŸºæœ¬è®¾è®¡å…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸€æˆåŠŸä¸»è¦å½’åŠŸäºæ®‹å·®è¿æ¥çš„ç®€æ´å½¢å¼ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œæ—©æœŸç ”ç©¶æ­ç¤ºäº†æ®‹å·®è¿æ¥çš„æ’ç­‰æ˜ å°„ç‰¹æ€§åœ¨å¤§è§„æ¨¡è®­ç»ƒä¸­ä¿æŒç¨³å®šæ€§å’Œæ•ˆç‡ã€‚é€šè¿‡é€’å½’æ‰©å±•æ®‹å·®è¿æ¥è·¨è¶Šå¤šå±‚ï¼Œç­‰å¼ï¼ˆ1ï¼‰å¾—å‡ºï¼š&lt;/p&gt;
&lt;p&gt;$$
\mathbf{x}_{L} = \mathbf{x}&lt;em&gt;l + \sum&lt;/em&gt;{i=l}^{L-1} \mathcal{F}(\mathbf{x}_l, W_l)             \tag{2}
$$&lt;/p&gt;
&lt;p&gt;å…¶ä¸­$L$å’Œ$l$åˆ†åˆ«å¯¹åº”è¾ƒæ·±å’Œè¾ƒæµ…çš„å±‚ã€‚æ’ç­‰æ˜ å°„é¡¹æŒ‡çš„æ˜¯ç»„ä»¶$x_l$æœ¬èº«ï¼Œå¼ºè°ƒäº†æ¥è‡ªè¾ƒæµ…å±‚çš„ä¿¡å·æœªç»ä»»ä½•ä¿®æ”¹ç›´æ¥æ˜ å°„åˆ°è¾ƒæ·±å±‚çš„ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;è¿‘æœŸï¼Œä»¥è¶…è¿æ¥ï¼ˆHyper-Connectionsï¼ŒHCï¼‰ï¼ˆZhu ç­‰äººï¼Œ2024ï¼‰ä¸ºä»£è¡¨çš„ç ”ç©¶ä¸ºæ®‹å·®è¿æ¥å¼•å…¥äº†æ–°ç»´åº¦ï¼Œå¹¶é€šè¿‡å®è¯éªŒè¯äº†å…¶æ€§èƒ½æ½œåŠ›ã€‚HCçš„å•å±‚æ¶æ„å¦‚å›¾1(b)æ‰€ç¤ºã€‚é€šè¿‡æ‰©å±•æ®‹å·®æµå®½åº¦å¹¶å¢å¼ºè¿æ¥å¤æ‚åº¦ï¼ŒHCåœ¨ä¸æ”¹å˜å•ä¸ªå•å…ƒæµ®ç‚¹è¿ç®—ï¼ˆFLOPsï¼‰è®¡ç®—å¼€é”€çš„å‰æä¸‹ï¼Œæ˜¾è‘—æå‡äº†æ‹“æ‰‘å¤æ‚åº¦ã€‚å½¢å¼åŒ–åœ°ï¼ŒHCä¸­çš„å•å±‚ä¼ æ’­å®šä¹‰ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;$$
\mathbf{x}_{l+1} = \mathcal{H}_l^{\text{res}} \mathbf{x}_l + \mathcal{H}_l^{\text{post}}{}^\top \mathcal{F}(\mathcal{H}_l^{\text{pre}}   \mathbf{x}_l, W_l)    \tag{3}
$$&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼Œ$\mathbf{x}&lt;em&gt;l$ å’Œ $\mathbf{x}&lt;/em&gt;{l+1}$ åˆ†åˆ«è¡¨ç¤ºç¬¬ $l$ å±‚çš„è¾“å…¥å’Œè¾“å‡ºã€‚ä¸å…¬å¼ (1) ä¸­çš„è¡¨è¿°ä¸åŒï¼Œ$\mathbf{x}&lt;em&gt;l$ å’Œ $\mathbf{x}&lt;/em&gt;{l+1}$ çš„ç‰¹å¾ç»´åº¦ä» $C$ æ‰©å±•åˆ°äº† $n \times C$ï¼Œå…¶ä¸­ $n$ æ˜¯æ‰©å±•å€ç‡ï¼ˆexpansion rateï¼‰ã€‚é¡¹ $\mathcal{H}_l^{\text{res}} \in \mathbb{R}^{n \times n}$ è¡¨ç¤ºä¸€ä¸ªå¯å­¦ä¹ çš„æ˜ å°„ï¼Œç”¨äºåœ¨æ®‹å·®æµï¼ˆresidual streamï¼‰å†…éƒ¨æ··åˆç‰¹å¾ã€‚åŒæ ·ä½œä¸ºå¯å­¦ä¹ æ˜ å°„ï¼Œ$\mathcal{H}_l^{\text{pre}} \in \mathbb{R}^{1 \times n}$ å°†æ¥è‡ª $nC$ ç»´æµä¸­çš„ç‰¹å¾èšåˆä¸ºä¸€ä¸ª $C$ ç»´çš„å±‚è¾“å…¥ï¼›åä¹‹ï¼Œ$\mathcal{H}_l^{\text{post}} \in \mathbb{R}^{1 \times n}$ å°†å±‚çš„è¾“å‡ºé‡æ–°æ˜ å°„å›åŸå§‹æµä¸­ã€‚&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
